<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Stock Market Earnings Project</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: #333;
      background-color: #f8f9fa;
    }
    .container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 40px 20px;
    }
    h1 {
      color: #2c3e50;
      font-size: 2.5em;
      margin-bottom: 30px;
      border-bottom: 3px solid #4CAF50;
      padding-bottom: 10px;
    }
    h2 {
      color: #2c3e50;
      font-size: 1.8em;
      margin: 30px 0 20px 0;
    }
    h3 {
      margin-top: 20px;
      color: #2c3e50;
      font-size: 1.2em;
      font-weight: 600;
    }
    p {
      margin-bottom: 18px;
      color: #495057;
    }
    .back-link {
      display: inline-block;
      color: #4CAF50;
      text-decoration: none;
      font-weight: 500;
      margin-top: 30px;
      transition: all 0.3s ease;
    }
    .back-link:hover {
      color: #45a049;
      transform: translateX(-5px);
    }
    .note-box {
      background: #e9f7ef;
      border: 1px solid #cde8d5;
      color: #255d3e;
      border-radius: 8px;
      padding: 14px 16px;
      margin: 10px 0 24px 0;
    }
    .project-description {
      background-color: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      margin: 20px 0;
    }
    .project-description p {
      margin: 10px 0;
      line-height: 1.6;
    }
    .project-description a {
      color: #4CAF50;
      text-decoration: none;
    }
    .project-description a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Stock Market Earnings Project</h1>
    <div class="badge badge-fixed"><span class="icon" aria-hidden="true">📈</span><span>Financial Analysis</span></div>

    <!-- Background Section -->
    <div class="project-description">
      <h2>Background & Context</h2>
      <p>
        Earnings announcements provide high volatility in the stock market, with opportunities available for investors and traders. 
        This project explored how historic pricing, earnings surprise, sentiment, and macroeconomic factors drive stock price movements 
        at earnings for Apple, Nvidia, and Google.
      </p>
      <p>
         The aim was to produce a model that gave reproducible and actionable insights — a case of 
         "when this happens, do this." Results needed to be repeatable, and the model adaptable to new market 
         and macro conditions.
      </p>
    </div>

    <div class="project-description">
        <h2>Model Framework</h2>
        <p>
          The final model originated from an initial idea around logic gates. For each stock and earnings event, 
          a composite score was generated based on EPS, macroeconomic indicators, volatility, 
          sentiment, and revenue.
        </p>
      
        <p>
          Composite scores were refined by applying stock-specific weights, discovered through 
          grid testing thousands of variations. For example:
        </p>
        <ul>
          <li>EPS: 25% (moderate earnings focus)</li>
          <li>Macro: 25% (high macro sensitivity)</li>
          <li>Volatility: 15% (moderate volatility consideration)</li>
          <li>Sentiment: 30% (high sentiment focus)</li>
          <li>Revenue: 5% (low revenue focus)</li>
        </ul>
      
        <p>
          Sub-scores also exist within certain factors — for instance, the Macro score is a 
          weighted combination of CPI, unemployment, and the Federal Funds Rate (EFFR).
        </p>
      
        <p>
         The composite score is compared against dynamic thresholds for each stock, 
         found through extensive grid testing to determine profitability points. These thresholds are 
         adaptive: in strong economic conditions with positive sentiment they are lowered to allow more trades, 
         while in uncertain or volatile periods they rise so only high-quality trades occur.
        </p>
      
        <p>
         The outcome is a decision system with three possible signals:  
         if the score is above the long threshold → Go Long,  
         if below the short threshold → Go Short,  
         if in between → Hold.
        </p>
      
       
   <div style="display: flex; gap: 20px; margin-top: 20px; justify-content: center; flex-wrap: wrap;">
     <div style="flex: 1; min-width: 300px; text-align: center;">
       <img src="earnings_project/plot1.png" alt="Model Flowchart" style="max-width: 100%; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.15);">
       <p style="font-size: 0.9em; color: #666; margin-top: 8px;">Figure: End-to-end model flow for signal generation</p>
     </div>
     <div style="flex: 1; min-width: 300px; text-align: center;">
       <img src="earnings_project/plot2.png" alt="Model Results" style="max-width: 100%; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.15);">
       <p style="font-size: 0.9em; color: #666; margin-top: 8px;">Figure: End-to-end model flow for signal generation</p>
     </div>
   </div>
</div>
      

    <!-- System Summary -->
    <div class="project-description">
      <h2>System Summary</h2>

      <h3>Unified Dataset Creation Process</h3>
      <p>
        We built a unified dataset combining 2015–2025 stock price, volatility, revenue, and macroeconomic, as well as sentiment data. The system integrates multiple data sources:
      </p>
        <ul>
          <li>Earnings Data: YFinance for historical earnings reports and estimates </li>
          <li>Price Data: Daily OHLCV (Open, High, Low, Close, Volume) data</li>
          <li>Macroeconomic Data: Federal Reserve Economic Data (FRED) for CPI, unemployment, and federal funds rate</li>
          <li>Sentiment Data: Alpha Vantage-derived sentiment scores combined with Reddit and X (Twitter) sentiment analysis</li>
          <li>Real-time Data: SEC filings for quarterly earnings announcements from 10-K and 10-Q filings</li>
        </ul>
      <p>
        Quarterly earnings reports from the SEC were merged with yFinance and Alpha Vantage pricing, plus Reddit/Twitter sentiment. 
        Temporal separation ensured no look-ahead bias.
      </p>

      <h3>Synthetic Data Generation</h3>
      <p>
        To overcome limited historical data (10 years of data for each stock, 42 real events per stock), the system generates synthetic events using four methods:
      </p>
        <ul>
          <li>Bootstrap Sampling (35%): Select similar historical events and add Gaussian noise while maintaining realistic correlations</li>
          <li>Volatility-Based Generation (25%): Scale returns based on volatility subscore with volatility-dependent noise</li>
          <li>Macro Regime-Based Generation (20%): Shift returns based on macroeconomic conditions and economic cycles</li>
          <li>Rolling Window Generation (20%): Use historical rolling averages with time-dependent noise</li>
        </ul>

      <h3>Feature Engineering</h3>
      <p>
        The system calculates five normalised subscores for each earnings event:
      </p>
        <ul>
          <li>EPS Subscore: Normalised earnings surprise percentage</li>
          <li>Macro Subscore: Weighted combination of CPI, unemployment, and EFFR</li>
          <li>Volatility Subscore: Pre-earnings volatility normalised against historical levels</li>
          <li>Sentiment Subscore: Combined Alpha Vantage and Twitter sentiment analysis</li>
          <li>Revenue Subscore: Proxy revenue surprise derived from earnings metrics</li>
        </ul>

      <h3>Machine Learning Models</h3>
      <p>
        The system is built using Python with key libraries including pandas for data manipulation, scikit-learn for machine learning models, 
        and numpy for numerical computations. The modular architecture allows for easy extension and modification of individual components.
      </p>
      <p>
        Multiple models were tested, including regression trees, random forests, and logistic regression. Classification models predicted 
        direction, while regression models estimated return magnitude. Features included EPS surprise, sentiment, macro trends, and volatility.
      </p>

      <h3>Enhanced Optimisation Process</h3>
      <p>
        We optimised thresholds and multipliers using grid search across thousands of combinations. Metrics such as hit rate and average 
        return were blended into a weighted score, with time-series cross-validation ensuring we avoid look-ahead bias.
      </p>
        <p>
         The system uses time-series cross-validation to ensure robust validation across different market cycles, 
         with strict temporal separation between training and testing periods to prevent look-ahead bias.
        </p>

       <h3>Stock-Specific Optimisations</h3>
        <p>
          Each stock required tailored settings: Apple favoured revenue-driven thresholds, Nvidia responded strongly to earnings volatility 
          and sentiment, while Google was more sensitive to macro and advertising revenue patterns.
        </p>
       
        <p>
          Time Window Optimisation: Identified optimal entry/exit windows around earnings announcement (T-5 to T+5 for AAPL, T-3 to T+7 for NVDA, T-2 to T+5 for GOOGL) 
          through systematic testing of multiple timeframes.
        </p>

      <h3>Adaptive Threshold System</h3>
      <p>
        Thresholds were not fixed but adjusted dynamically based on current macroeconomic and sentiment conditions. This adaptive system 
        allowed the model to respond to changing market conditions.
      </p>

      <h3>Complete System Flow</h3>
      <p>
        The final pipeline: load dataset → optimize thresholds → calculate composite scores → apply adaptive thresholds → generate signals → 
        evaluate performance. This end-to-end system produced consistent, reproducible results.
      </p>
    </div>

    <div class="project-description">
        <h2>Results & Testing</h2>
        <p>
          To evaluate the system, we tested it against the latest three earnings events from Apple, Nvidia, and Google. 
          Two of these events (Apple and Nvidia) occurred after the data collection period, 
          meaning the model had no prior knowledge of them.  
        </p>
      
        <p>
          Although Google's earnings event was part of the dataset, the implementation was specifically designed 
          to avoid look-ahead bias, making it a strong validation case as well.
        </p>
      
        <div style="text-align: center; margin: 20px 0;">
          <img src="earnings_project/real_earnings.png" alt="Real Earnings Events" style="max-width: 100%; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.15);">
          <p style="font-size: 0.9em; color: #666; margin-top: 8px;">Figure: Real earnings events for Apple, Nvidia, and Google</p>
        </div>
      
        <p>
          The headline results when tested against these real events were:
        </p>
        <ul>
          <li>Correctly predicted the direction of trade (long or short) for all three stocks.</li>
          <li>Overestimated Google returns for the time frame by approximately 1.1%.</li>
          <li>Underestimated Apple returns by approximately 4.8%.</li>
          <li>The model lost money on Nvidia despite the correct directional prediction — the system favoured short trades, but 
              there were very few short signals, and they were not consistently profitable.</li>
        </ul>
      
        <div style="text-align: center; margin: 20px 0;">
          <img src="earnings_project/test_results.png" alt="Test Results Performance" style="max-width: 100%; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.15);">
          <p style="font-size: 0.9em; color: #666; margin-top: 8px;">Figure: Model test results across the latest earnings events</p>
        </div>
      
       <p>
         These findings revealed valuable insights, particularly around Nvidia, where a 
         "sell the news" effect was observed. This suggests further model adjustments are needed 
         to better capture such market dynamics.
       </p>
     </div>

     <!-- Usage Section -->
     <div class="project-description">
       <h2>Usage</h2>
       
       <h3>Interactive Testing Interface</h3>
       <p>
         The system includes an interactive test script that allows users to experiment with different trading strategies 
         and configurations
       </p>
       
       <h3>Available Options</h3>
       <ul>
         <li>Stock Selection: Test individual stocks (AAPL, NVDA, GOOGL) or all stocks combined</li>
         <li>Time Windows: Choose from T-1 to T+1 through T-10 to T+10, or specify custom windows</li>
         <li>Dataset Options: Use real events only or include synthetic data for expanded testing</li>
         <li>Trading Costs: Test scenarios from academic (no costs) to institutional trading</li>
         <li>EPS Timing: Enable to use pre-earnings or post-earnings composite score</li>
         <li>Detailed Reasoning: View detailed explanations of strategy decisions</li>
       </ul>

       <h3>Example Output</h3>
       <div style="background-color: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 15px; margin: 15px 0; max-height: 400px; overflow-y: auto; font-family: 'Courier New', monospace; font-size: 0.85em; line-height: 1.4;">
         <div style="color: #495057; white-space: pre-wrap;">Found 1302 events for AAPL
Filtered to 42 real events only
Testing with 42 real events
Using pre-earnings composite score (composite_pre) for T-1 entry
Warning: Falling back to composite_pre for AAPL
Predicted return range: -0.250 to 0.250
Using standard adaptive optimization

STRATEGY RESULTS:

TRADING COSTS: None
  Description: No trading costs (academic study)
  Commission: 0.00%
  Spread: 0.00%
  Slippage: 0.00%
  Total per trade: 0.00%
  Total per round-trip: 0.00%
Long Trades (Combined adaptive thresholds, base=0.024, avg_adjusted=0.032):
  Count: 26
  Hit Rate: 0.538
  Avg Return: 0.0136
  Total Return: 0.3316
  Std Dev: 0.0722
  Sharpe Ratio: 0.826

Short Trades (Combined adaptive thresholds, base=-0.020, avg_adjusted=-0.029):
  Count: 12
  Hit Rate: 0.500
  Avg Return: -0.0292
  Total Return: -0.3261
  Std Dev: 0.0785
  Sharpe Ratio: -1.868 (no risk-free rate adjustment for shorts)

SHARPE RATIO INTERPRETATION:
  Long Trades: Risk-adjusted return vs 4.33% risk-free rate
  Short Trades: Pure risk-adjusted return (no capital invested)
  Positive Sharpe = Good risk-adjusted performance
  Negative Sharpe = Poor risk-adjusted performance
  Higher is better: 1.0+ good, 2.0+ excellent

Neutral Trades (between thresholds):
  Count: 4
  Hit Rate: 0.250
  Avg Return: -0.0332

All Trades (no filtering):
  Count: 42
  Hit Rate: 0.500
  Avg Return: 0.0136
  Total Return: 0.5813
  Sharpe Ratio: 0.806

CUMULATIVE RETURNS ANALYSIS:
  Long Trades Cumulative: 0.3316 (26 trades)
  Short Trades Cumulative: -0.3261 (12 trades)
  Combined Strategy: 0.0055
  Best Strategy: LONG trades (0.3316 vs -0.3261)

SIGNAL vs PERFORMANCE ANALYSIS:
  Long Trades: Avg=0.0136, Hit Rate=0.538, Count=26
  Short Trades: Avg=-0.0292, Hit Rate=0.500, Count=12
  ALIGNED: Long trades perform better, system favors LONG signals

==================================================
STRATEGY REASONING & DECISION FACTORS
==================================================
1. MACROECONOMIC ASSUMPTIONS:
   - EFFR: 4.33% (current rate - 2025-06)
   - Core CPI: 327.6 (latest reading - 2025-06)
   - Unemployment: 4.1% (current level - 2025-06)
   - Macro Regime: Contraction
   - Threshold Impact: -0.010

2. ROLLING PERIOD ANALYSIS:
   - Training Window: T-10 to T-2 (8 days)
   - Validation Window: T+1 to T+20 (20 days)
   - Lookback Period: 252 days (1 year)
   - Volatility Window: T-10 to T-2

3. COMPOSITE SCORE BREAKDOWN:
   - EPS Subscore: 0.42 (weight: 40.0%)
   - Macro Subscore: -0.32 (weight: 15.0%)
   - Vol Subscore: 0.20 (weight: 10.0%)
   - Sentiment Subscore: -0.74 (weight: 30.0%)
   - Revenue Subscore: -0.22 (weight: 5.0%)
   - Composite Score: -0.092

4. THRESHOLD CALCULATION:
   - COMBINED ADAPTIVE Thresholds: Window-based + Market conditions
   - Base Long Threshold: 0.024 (optimized for T-1 to T1)
   - Base Short Threshold: -0.020 (optimized for T-1 to T1)
   - Average Adjusted Long: 0.032 (with market condition adjustments)
   - Average Adjusted Short: -0.029 (with market condition adjustments)
   - Market Adjustments: Macro (±0.05), Sentiment (±0.03) [Volatility removed per Option 1]
   - Signal: SHORT

5. DECISION FACTORS:
   - Entry Logic: Buy at T-1
   - Exit Logic: Sell at T1
   - Position Size: Full position
   - Risk Management: None (academic study)
   - Model Confidence: 68%
   - Data Usage: All 3906 events

6. UNCERTAINTY MEASURES:
   - Standard Error: ±0.045
   - Confidence Interval: 0.589-0.679
   - Model Stability: High
   - Data Quality: Good
   - Historical Coverage: 2015-2025

7. SENTIMENT ANALYSIS:
   - Alpha Vantage Sentiment: -0.518
   - New Sentiment Score: nan
   - Combined Sentiment: -0.518
   - Sentiment Coverage: 100%</div>
       </div>
       </ul>

       <h3>Threshold Types</h3>
       <p>
         The system uses standard adaptive thresholds that combine window-based optimisation with market condition adjustments. 
         This approach ensures reliable performance across different market environments while maintaining methodological rigour.
       </p>

      

      

       <h3>Performance Metrics</h3>
       <p>
         The system provides detailed performance evaluation including:
       </p>
       <ul>
         <li>Hit Rate: Percentage of profitable trades</li>
         <li>Average Return: Mean return per trade</li>
         <li>Sharpe Ratio: Risk-adjusted performance with 4.33% risk-free rate</li>
         <li>Cumulative Return: Total strategy performance over all events in the dataset</li>
         <li>Signal vs Performance Analysis: Comparative evaluation of long vs short strategies</li>
       </ul>

       <h3>Risk Management</h3>
       <ul>
         <li>Return Bounds: Maximum cumulative returns (AAPL: ±100%, NVDA: ±200%, GOOGL: ±100%)</li>
         <li>Return Capping: Clips returns to realistic ranges (-50% to +50% daily)</li>
         <li>Market Regime Awareness: Adapts to bullish, bearish, and neutral market conditions</li>
       </ul>
     </div>

     <!-- Web Interface Section -->
     <div class="project-description">
       <h2>Web Interface</h2>
       
       <p>
         The system includes a web interface built with Flask that provides an easy to use alternative to the command line interface. This replicates the usage an analyst might have, and provides great benefit when demonstrating the model to stakeholders.
       </p>
       
       <h3>Interface Features</h3>
       <ul>
         <li>Stock Selection: Choose individual stocks (AAPL, NVDA, GOOGL) or test all stocks combined</li>
         <li>Strategy Testing: Interactive form matching the command-line interface functionality</li>
         <li>Trading Costs selector </li>
         <li>Data Set Selector - use real events only or include synthetic data for expanded testing</li>
         <li> Detailed Reasoning - View full explanations of trading decisions or disable for faster results</li>
       </ul>

      

       <div style="margin-top: 20px;">
         <div style="text-align: center; margin-bottom: 30px;">
           <img src="earnings_project/web1.png" alt="Web Interface Screenshot 1" style="max-width: 100%; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.15);">
           <p style="font-size: 0.9em; color: #666; margin-top: 8px;">Figure: Web interface main dashboard</p>
         </div>
         <div style="text-align: center; margin-bottom: 30px;">
           <img src="earnings_project/web2.png" alt="Web Interface Screenshot 2" style="max-width: 100%; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.15);">
           <p style="font-size: 0.9em; color: #666; margin-top: 8px;">Figure: Strategy testing interface</p>
         </div>
         <div style="text-align: center; margin-bottom: 30px;">
           <img src="earnings_project/web3.png" alt="Web Interface Screenshot 3" style="max-width: 100%; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.15);">
           <p style="font-size: 0.9em; color: #666; margin-top: 8px;">Figure: System overview and results</p>
         </div>
       </div>
     </div>

    <a href="index.html" class="back-link">← Back to Portfolio</a>
  </div>
</body>
</html>
